# StockNow API Documentation

## Since we're working with a GraphQL backend, instead of traditional CRUD operations we have query's and mutations

### **Query**

- api name: userWatchList
- description: Retrieve a user's watchlist
- request: `POST /graphql`
    - content-type: `application/json`
    - body: object
      - email: (string) the email of the user we want to query
- response: 200
    - content-type: `application/json`
    - body: object
        - data
            - userWatchList: (string array) list of stock symbols

``` 
$ curl  -X POST 
        -H "Content-Type: application/json" 
        -d '{ "query": "query { userWatchList(email:\"test@test.com\") }" }' 
        http://localhost:4000/graphql
```
<br />

- api name: login
- description: Generates a json webtoken when the user logins in with valid credentials
- request: `POST /grahql`
    - content-type: `application/json`
    - body: object
      - email: (string) the email of the user
      - password: (string) the password of the user
- response: 200
    - content-type: `application/json`
    - body: object
        - data
            - login
                - userId: (string) auto generated by database
                - email: (string) the email of the user
                - token: (string) generated by json webtoken package
                - tokenExp: (Int) default as 12hours
                - symbols: (string array) list of stock symbols
                - twoFactor: (boolean) if 2fa is enabled for this user
                - twoFactorSecret: (string) two factor secret 
                - twoFactorSecretAscii: (string) two factor secret ascii encoded

``` 
$ curl -X POST 
       -H "Content-Type: application/json" 
       -d '{ 
           "query": "query { login(email:\"test@test.com\", password:\"123Password123\") 
                { userId email token tokenExp symbols } 
            }" 
        }' 
       http://localhost:4000/graphql
```
<br />

### **Mutation**

- api name: addSymbol
- description: Add a symbol to a users watchlist
- request: `POST /graphql`
    - content-type: `application/json`
    - authorization: `Bearer YOUR_TOKEN_HERE`
    - body: object
      - email: (string) the email of the user
      - symbol: (string) the stock the user wants to add
- response: 200
    - content-type: `application/json`
    - body: object
        - data
            - addSymbol
                - _id: (string) auto generated by db
                - email: (string) the email of the user
                - password: (string) the salted hash of the password
                - user: (string) the name of the user
                - symbols: (string array) list of stock symbols
                - twoFactor: (boolean) if 2fa is enabled for this user
                - twoFactorSecret: (string) two factor secret 
                - twoFactorSecretAscii: (string) two factor secret ascii encoded
                
 
``` 
$ curl -X POST 
       -H "Content-Type: application/json" 
       -H "Authorization: Bearer YOUR_TOKEN_HERE"
       -d '{ 
           "query": "mutation {
                addSymbol(email:\"test@test.com\", symbol:\"GME\")
                    {_id email password user symbols}
                }" 
        }' 
       http://localhost:4000/graphql
``` 
<br />

- api name: deleteSymbol
- description: Delete a symbol from a users watchlist
- request: `POST /graphql`
    - content-type: `application/json`
    - authorization: `Bearer YOUR_TOKEN_HERE`
    - body: object
      - email: (string) the email of the user
      - symbol: (string) the stock the user wants to add
- response: 200
    - content-type: `application/json`
    - body: object
        - data
            - addSymbol
                - _id: (string) auto generated by db
                - email: (string) the email of the user
                - password: (string) the salted hash of the password
                - user: (string) the name of the user
                - symbols: (string array) list of stock symbols
                - twoFactor: (boolean) if 2fa is enabled for this user
                - twoFactorSecret: (string) two factor secret 
                - twoFactorSecretAscii: (string) two factor secret ascii encoded
 
``` 
$ curl -X POST 
       -H "Content-Type: application/json" 
       -H "Authorization: Bearer YOUR_TOKEN_HERE"
       -d '{ 
           "query": "mutation {
                deleteSymbol(email:\"test@test.com\", symbol:\"GME\")
                    {_id email password user symbols}
                }" 
        }' 
       http://localhost:4000/graphql
``` 
<br /> activateTwoFactor(email: String!, secret: String!, asciiSecret: String!): User

- api name: activateTwoFactor
- description: Enables two factor authentication for the users account
- request: `POST /graphql`
    - content-type: `application/json`
    - authorization: `Bearer YOUR_TOKEN_HERE`
    - body: object
      - email: (string) the email of the user
      - secret: (string) two factor secret
      - asciiSecret: (string) two factor secret in ascii
- response: 200
    - content-type: `application/json`
    - body: object
        - data
            - addSymbol
                - _id: (string) auto generated by db
                - email: (string) the email of the user
                - password: (string) the salted hash of the password
                - user: (string) the name of the user
                - symbols: (string array) list of stock symbols
                - twoFactor: (boolean) if 2fa is enabled for this user
                - twoFactorSecret: (string) two factor secret 
                - twoFactorSecretAscii: (string) two factor secret ascii encoded
 
``` 
$ curl -X POST 
       -H "Content-Type: application/json" 
       -H "Authorization: Bearer YOUR_TOKEN_HERE"
       -d '{ 
           "query": "mutation {
                deleteSymbol(email:\"test@test.com\", symbol:\"GME\")
                    {_id email password user symbols}
                }" 
        }' 
       http://localhost:4000/graphql
``` 
<br />

- api name: signup
- description: Create an account for a new user with their specified credentials
- request: `POST /graphql`
    - content-type: `application/json`
    - body: object
      - email: (string) the email of the user
      - password: (string) the password of the user
      - user: (string) the name of the user
- response: 200
    - content-type: `application/json`
    - body: object
        - data
            - addSymbol
                - _id: (string) auto generated by db
                - email: (string) the email of the user
                - password: (string) the salted hash of the password
                - user: (string) the name of the user
                - symbols: (string array) an empty list of stock symbols
                - twoFactor: (boolean) if 2fa is enabled for this user
                - twoFactorSecret: (string) two factor secret 
                - twoFactorSecretAscii: (string) two factor secret ascii encoded
 
``` 
$ curl -X POST 
       -H "Content-Type: application/json" 
       -H "Authorization: Bearer YOUR_TOKEN_HERE"
       -d '{ 
           "query": "mutation {
                signup(email:\"test@test.com\", password:\"123Password123\", user:\"JimmyAndHoward\")
                    {_id email password user symbols}
                }" 
        }' 
       http://localhost:4000/graphql
``` 
<br />